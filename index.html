<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kirschtarmyliga 1.0</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-white min-h-screen">
<div class="max-w-6xl mx-auto p-6">

<h1 class="text-4xl font-bold text-center mb-8">
ğŸ¯ Kirschtarmyliga 1.0
</h1>

<!-- LOGIN -->
<div class="bg-gray-800 p-4 rounded-xl mb-6 text-center">
<input id="adminEmail" type="email" placeholder="Admin Email"
class="p-2 text-black rounded mb-2 w-64">
<input id="adminPass" type="password" placeholder="Passwort"
class="p-2 text-black rounded mb-2 w-64">
<div>
<button onclick="login()" class="bg-green-600 px-4 py-2 rounded">Login</button>
<button onclick="logout()" id="logoutBtn"
class="bg-red-600 px-4 py-2 rounded hidden">Logout</button>
</div>
<p id="loginStatus" class="mt-2 text-sm text-red-400"></p>
</div>

<!-- LIGA BUTTONS -->
<div class="flex flex-wrap justify-center gap-4 mb-6">
<button onclick="switchLiga('liga1')" class="bg-blue-600 px-4 py-2 rounded">Liga 1</button>
<button onclick="switchLiga('liga2')" class="bg-purple-600 px-4 py-2 rounded">Liga 2</button>
<button onclick="switchLiga('liga3')" class="bg-green-600 px-4 py-2 rounded">Liga 3</button>
<button onclick="switchLiga('liga4')" class="bg-red-600 px-4 py-2 rounded">Liga 4</button>
</div>

<h2 id="ligaTitle" class="text-2xl font-bold text-center mb-4"></h2>

<!-- SPIELER -->
<div class="bg-gray-800 p-6 rounded-xl mb-8">
<h3 class="text-xl font-bold mb-4">ğŸ‘¥ Spieler</h3>
<ul id="playerList" class="mb-4 space-y-1"></ul>
<button id="addPlayerBtn"
onclick="addPlayer()"
class="bg-green-600 px-4 py-2 rounded hidden">
â• Spieler hinzufÃ¼gen
</button>
</div>

<!-- SPIEL HINZUFÃœGEN -->
<div class="bg-gray-800 p-6 rounded-xl mb-8">
<h3 class="text-xl font-bold mb-4">ğŸ—“ Spiel hinzufÃ¼gen</h3>

<div class="grid grid-cols-2 gap-4 mb-4">
<select id="heimSelect" class="text-black p-2 rounded"></select>
<select id="gastSelect" class="text-black p-2 rounded"></select>
<input id="spieltagInput" type="number" placeholder="Spieltag"
class="text-black p-2 rounded">
<input id="resultInput" placeholder="Ergebnis z.B 6:4"
class="text-black p-2 rounded">
</div>

<button id="addMatchBtn"
onclick="addMatch()"
class="bg-blue-600 px-4 py-2 rounded hidden">
Spiel speichern
</button>

<hr class="my-6 border-gray-600">

<table class="w-full text-center" id="matchTable">
<thead class="bg-gray-700">
<tr>
<th>Spieltag</th>
<th>Heim</th>
<th>Gast</th>
<th>Ergebnis</th>
<th id="deleteHeader" class="hidden">âŒ</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- TABELLE -->
<div class="bg-gray-800 p-6 rounded-xl">
<h3 class="text-xl font-bold mb-4">ğŸ“Š Tabelle</h3>
<table class="w-full text-center" id="leagueTable">
<thead class="bg-gray-700">
<tr>
<th>Team</th>
<th>Sp</th>
<th>S</th>
<th>U</th>
<th>Leg+</th>
<th>Leg-</th>
<th>Diff</th>
<th>P</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

</div>

<script>
const ADMIN_EMAIL = "janblut18@gmail.com";
const ADMIN_PASSWORD = "Janjaq2308!!";

let currentLiga = "liga1";
let isAdmin = false;

function login(){
if(adminEmail.value === ADMIN_EMAIL && adminPass.value === ADMIN_PASSWORD){
isAdmin = true;
localStorage.setItem("adminLogged","true");
enableAdmin();
loginStatus.innerText = "";
}else{
loginStatus.innerText = "Falsche Email oder Passwort!";
}
}

function logout(){
isAdmin = false;
localStorage.removeItem("adminLogged");
disableAdmin();
}

function enableAdmin(){
addMatchBtn.classList.remove("hidden");
addPlayerBtn.classList.remove("hidden");
deleteHeader.classList.remove("hidden");
logoutBtn.classList.remove("hidden");
}

function disableAdmin(){
addMatchBtn.classList.add("hidden");
addPlayerBtn.classList.add("hidden");
deleteHeader.classList.add("hidden");
logoutBtn.classList.add("hidden");
}

function switchLiga(liga){
currentLiga = liga;
ligaTitle.innerText = "Liga " + liga.replace("liga","");
loadPlayers();
loadMatches();
}

function getData(key){
return JSON.parse(localStorage.getItem(key)) || [];
}

function setData(key,data){
localStorage.setItem(key,JSON.stringify(data));
}

function addPlayer(){
const name = prompt("Spielername:");
if(!name) return;
let players = getData("players_"+currentLiga);
players.push(name);
setData("players_"+currentLiga,players);
loadPlayers();
}

function loadPlayers(){
let players = getData("players_"+currentLiga);
playerList.innerHTML="";
heimSelect.innerHTML="";
gastSelect.innerHTML="";
players.forEach((p,i)=>{
playerList.innerHTML += `
<li class="flex justify-between bg-gray-700 p-2 rounded">
${p}
${isAdmin?`<button onclick="deletePlayer(${i})" class="text-red-400">X</button>`:""}
</li>`;
heimSelect.innerHTML += `<option>${p}</option>`;
gastSelect.innerHTML += `<option>${p}</option>`;
});
}

function deletePlayer(i){
let players = getData("players_"+currentLiga);
players.splice(i,1);
setData("players_"+currentLiga,players);
loadPlayers();
}

function addMatch(){
let matches = getData("matches_"+currentLiga);
matches.push({
spieltag: spieltagInput.value,
heim: heimSelect.value,
gast: gastSelect.value,
result: resultInput.value
});
setData("matches_"+currentLiga,matches);
loadMatches();
}

function loadMatches(){
let matches = getData("matches_"+currentLiga);
matchTable.querySelector("tbody").innerHTML="";
let tableData={};

matches.forEach((m,i)=>{
matchTable.querySelector("tbody").innerHTML+=`
<tr>
<td>${m.spieltag}</td>
<td>${m.heim}</td>
<td>${m.gast}</td>
<td>${m.result}</td>
${isAdmin?`<td><button onclick="deleteMatch(${i})" class="text-red-400">X</button></td>`:""}
</tr>`;

if(!m.result.includes(":")) return;

let [h,a]=m.result.split(":").map(Number);

if(!tableData[m.heim])
tableData[m.heim]={spiele:0,siege:0,unentschieden:0,legsPlus:0,legsMinus:0,punkte:0};
if(!tableData[m.gast])
tableData[m.gast]={spiele:0,siege:0,unentschieden:0,legsPlus:0,legsMinus:0,punkte:0};

tableData[m.heim].spiele++;
tableData[m.gast].spiele++;
tableData[m.heim].legsPlus+=h;
tableData[m.heim].legsMinus+=a;
tableData[m.gast].legsPlus+=a;
tableData[m.gast].legsMinus+=h;

if(h>a){tableData[m.heim].siege++;tableData[m.heim].punkte+=3;}
else if(h<a){tableData[m.gast].siege++;tableData[m.gast].punkte+=3;}
else{
tableData[m.heim].unentschieden++;
tableData[m.gast].unentschieden++;
tableData[m.heim].punkte+=1;
tableData[m.gast].punkte+=1;
}
});

let teams = Object.keys(tableData).sort((a,b)=>{
if(tableData[b].punkte !== tableData[a].punkte)
return tableData[b].punkte-tableData[a].punkte;
return (tableData[b].legsPlus-tableData[b].legsMinus)-
(tableData[a].legsPlus-tableData[a].legsMinus);
});

leagueTable.querySelector("tbody").innerHTML="";

teams.forEach((team,index)=>{
let d=tableData[team];
let rowClass="";
if(index===0) rowClass="bg-green-600";
if(index===teams.length-1) rowClass="bg-red-600";

leagueTable.querySelector("tbody").innerHTML+=`
<tr class="${rowClass}">
<td>${team}</td>
<td>${d.spiele}</td>
<td>${d.siege}</td>
<td>${d.unentschieden}</td>
<td>${d.legsPlus}</td>
<td>${d.legsMinus}</td>
<td>${d.legsPlus-d.legsMinus}</td>
<td>${d.punkte}</td>
</tr>`;
});
}

function deleteMatch(i){
let matches=getData("matches_"+currentLiga);
matches.splice(i,1);
setData("matches_"+currentLiga,matches);
loadMatches();
}

if(localStorage.getItem("adminLogged")==="true"){
isAdmin=true;
enableAdmin();
}

switchLiga("liga1");
</script>

</body>
</html>
